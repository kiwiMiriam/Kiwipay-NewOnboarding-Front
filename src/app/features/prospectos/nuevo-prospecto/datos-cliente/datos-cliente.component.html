<div class="section-container">

      <form [formGroup]="clientForm" (ngSubmit)="onSubmit()">
        <!-- INFORMACIÓN TITULAR -->
        <div class="section-header">
          <h4>Información del Titular</h4>
          <small class="required-note">Los campos marcados con * son obligatorios</small>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="tipoDocumento">Tipo de Documento *</label>
            <select id="tipoDocumento" formControlName="tipoDocumento">
              <option value="">Seleccione...</option>
              <option value="DNI">DNI</option>
              <option value="CE">Carnet de Extranjería</option>
              <option value="PASAPORTE">Pasaporte</option>
            </select>
            @if (submitted && f['tipoDocumento'].errors) {
              <div class="error-message">El tipo de documento es requerido</div>
            }
          </div>

          <div class="form-group">
            <label for="numeroDocumento">Número de Documento *</label>
            <input type="text" id="numeroDocumento" formControlName="numeroDocumento">
            @if (submitted && f['numeroDocumento'].errors) {
              <div class="error-message">
                @if (f['numeroDocumento'].errors['required']) {
                  El número de documento es requerido
                } @else if (f['numeroDocumento'].errors['pattern']) {
                  El formato del documento no es válido
                }
              </div>
            }
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="nombres">Nombres *</label>
            <input type="text" id="nombres" formControlName="nombres">
            @if (submitted && f['nombres'].errors) {
              <div class="error-message">Este campo es requerido</div>
            }
          </div>

          <div class="form-group">
            <label for="apellidos">Apellidos *</label>
            <input type="text" id="apellidos" formControlName="apellidos">
            @if (submitted && f['apellidos'].errors) {
              <div class="error-message">Este campo es requerido</div>
            }
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="estadoCivil">Estado Civil *</label>
            <select id="estadoCivil" formControlName="estadoCivil" required>
              <option value="">Seleccione...</option>
              <option value="SINGLE">Soltero(a)</option>
              <option value="MARRIED">Casado(a)</option>
              <option value="DIVORCED">Divorciado(a)</option>
              <option value="WIDOWED">Viudo(a)</option>
              <option value="COHABITANT">Conviviente</option>
            </select>
            @if (submitted && f['estadoCivil'].errors) {
              <div class="error-message">Este campo es requerido</div>
            }
          </div>

          <div class="form-group">
            <label for="fechaNacimiento">Fecha de Nacimiento *</label>
            <input type="date" id="fechaNacimiento" formControlName="fechaNacimiento">
            @if (submitted && f['fechaNacimiento'].errors) {
              <div class="error-message">Este campo es requerido</div>
            }
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="sexo">Sexo *</label>
            <select id="sexo" formControlName="sexo" required>
              <option value="">Seleccione...</option>
              <option value="M">Masculino</option>
              <option value="F">Femenino</option>
            </select>
            @if (submitted && f['sexo'].errors) {
              <div class="error-message">Este campo es requerido</div>
            }
          </div>

          <div class="form-group">
            <label for="correo">Correo Electrónico *</label>
            <input type="email" id="correo" formControlName="correo">
            @if (submitted && f['correo'].errors) {
              <div class="error-message">
                @if (f['correo'].errors['required']) {
                  El correo es requerido
                } @else if (f['correo'].errors['email']) {
                  El formato del correo no es válido
                }
              </div>
            }
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="telefono">Teléfono *</label>
            <input type="tel" id="telefono" formControlName="telefono">
            @if (submitted && f['telefono'].errors) {
              <div class="error-message">Este campo es requerido</div>
            }
          </div>
        </div>

        <div class="form-row">
          <div class="form-group full-width">
            <label class="question-label">
              ¿El cliente/titular sufre de algún padecimiento?
            </label>
            <div class="toggle-buttons">
              <button 
                type="button" 
                class="toggle-btn yes-btn" 
                [class.active]="clientForm.get('suffersCondition')?.value === true"
                (click)="onSuffersConditionChange(true)"
                title="Sí, tiene padecimientos">
                <span class="btn-icon">✓</span>
                <span class="btn-text">Sí</span>
                <span class="btn-status" *ngIf="clientForm.get('suffersCondition')?.value === true">(Seleccionado)</span>
              </button>
              <button 
                type="button" 
                class="toggle-btn no-btn" 
                [class.active]="clientForm.get('suffersCondition')?.value === false"
                (click)="onSuffersConditionChange(false)"
                title="No tiene padecimientos">
                <span class="btn-icon">✗</span>
                <span class="btn-text">No</span>
                <span class="btn-status" *ngIf="clientForm.get('suffersCondition')?.value === false">(Seleccionado)</span>
              </button>
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="departamento">Departamento *</label>
            <select id="departamento" formControlName="departamento" (change)="onDepartamentoChange()">
              <option value="">Seleccione...</option>
              <option *ngFor="let dep of departamentos" [value]="dep.id">{{ dep.name }}</option>
            </select>
            @if (submitted && f['departamento'].errors) {
              <div class="error-message">Este campo es requerido</div>
            }
          </div>

          <div class="form-group">
            <label for="provincia">Provincia *</label>
            <select id="provincia" formControlName="provincia" (change)="onProvinciaChange()">
              <option value="">Seleccione...</option>
              <option *ngFor="let prov of provincias" [value]="prov.id">{{ prov.name }}</option>
            </select>
            @if (submitted && f['provincia'].errors) {
              <div class="error-message">Este campo es requerido</div>
            }
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="distrito">Distrito *</label>
            <select id="distrito" formControlName="distrito">
              <option value="">Seleccione...</option>
              <option *ngFor="let dist of distritos" [value]="dist.id">{{ dist.name }}</option>
            </select>
            @if (submitted && f['distrito'].errors) {
              <div class="error-message">Este campo es requerido</div>
            }
          </div>

          <div class="form-group full-width">
            <label for="direccion">Dirección *</label>
            <input type="text" id="direccion" formControlName="direccion">
            @if (submitted && f['direccion'].errors) {
              <div class="error-message">Este campo es requerido</div>
            }
          </div>
        </div>

        <!-- INFORMACIÓN PACIENTE (Sección expandible - opcional) -->
        <div class="expandable-section">
          <div class="section-toggle" (click)="togglePaciente()">
            <div class="section-header">
              <h4>Información del Paciente</h4>
              <small>(opcional)</small>
            </div>
            <span class="toggle-icon">{{ isPacienteExpanded ? '▼' : '►' }}</span>
          </div>

          @if (isPacienteExpanded) {
            <div class="expanded-content" formGroupName="paciente">
              <div class="form-row">
                <div class="form-group">
                  <label for="pacienteTipoDocumento">Tipo de Documento</label>
                  <select id="pacienteTipoDocumento" formControlName="tipoDocumento">
                    <option value="">Seleccione...</option>
                    <option value="DNI">DNI</option>
                    <option value="CE">Carnet de Extranjería</option>
                    <option value="PASAPORTE">Pasaporte</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="pacienteNumeroDocumento">Número de Documento</label>
                  <input type="text" id="pacienteNumeroDocumento" formControlName="numeroDocumento">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="pacienteNombres">Nombres</label>
                  <input type="text" id="pacienteNombres" formControlName="nombres">
                </div>

                <div class="form-group">
                  <label for="pacienteApellidos">Apellidos</label>
                  <input type="text" id="pacienteApellidos" formControlName="apellidos">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="pacienteSexo">Sexo</label>
                  <select id="pacienteSexo" formControlName="sexo">
                    <option value="">Seleccione...</option>
                    <option value="M">Masculino</option>
                    <option value="F">Femenino</option>
                    <option value="O">Otro</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="pacienteTelefono">Teléfono</label>
                  <input type="tel" id="pacienteTelefono" formControlName="telefono">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="pacienteCorreo">Correo Electrónico</label>
                  <input type="email" id="pacienteCorreo" formControlName="correo">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="pacienteDepartamento">Departamento</label>
                  <select id="pacienteDepartamento" formControlName="departamento" (change)="onPacienteDepartamentoChange()">
                    <option value="">Seleccione...</option>
                    <option *ngFor="let dep of departamentos" [value]="dep.id">{{ dep.name }}</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="pacienteProvincia">Provincia</label>
                  <select id="pacienteProvincia" formControlName="provincia" (change)="onPacienteProvinciaChange()">
                    <option value="">Seleccione...</option>
                    <option *ngFor="let prov of pacienteProvincias" [value]="prov.id">{{ prov.name }}</option>
                  </select>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="pacienteDistrito">Distrito</label>
                  <select id="pacienteDistrito" formControlName="distrito">
                    <option value="">Seleccione...</option>
                    <option *ngFor="let dist of pacienteDistritos" [value]="dist.id">{{ dist.name }}</option>
                  </select>
                </div>

                <div class="form-group full-width">
                  <label for="pacienteDireccion">Dirección</label>
                  <input type="text" id="pacienteDireccion" formControlName="direccion">
                </div>
              </div>


            </div>
          }
        </div>

        <!-- INFORMACIÓN CONYUGUE (Sección expandible - opcional) -->
        <div class="expandable-section">
          <div class="section-toggle" (click)="toggleConyugue()">
            <div class="section-header">
              <h4>Información del Cónyuge</h4>
              <small>(opcional)</small>
            </div>
            <span class="toggle-icon">{{ isConyugueExpanded ? '▼' : '►' }}</span>
          </div>

          @if (isConyugueExpanded) {
            <div class="expanded-content" formGroupName="conyugue">
              <div class="form-row">
                <div class="form-group">
                  <label for="conyugueTipoDocumento">Tipo de Documento</label>
                  <select id="conyugueTipoDocumento" formControlName="tipoDocumento">
                    <option value="">Seleccione...</option>
                    <option value="DNI">DNI</option>
                    <option value="CE">Carnet de Extranjería</option>
                    <option value="PASAPORTE">Pasaporte</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="conyugueNumeroDocumento">Número de Documento</label>
                  <input type="text" id="conyugueNumeroDocumento" formControlName="numeroDocumento">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="conyugueNombres">Nombres</label>
                  <input type="text" id="conyugueNombres" formControlName="nombres">
                </div>

                <div class="form-group">
                  <label for="conyugueApellidos">Apellidos</label>
                  <input type="text" id="conyugueApellidos" formControlName="apellidos">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="conyugueCorreo">Correo Electrónico</label>
                  <input type="email" id="conyugueCorreo" formControlName="correo">
                </div>

                <div class="form-group">
                  <label for="conyugueTelefono">Teléfono</label>
                  <input type="tel" id="conyugueTelefono" formControlName="telefono">
                </div>
              </div>
            </div>
          }
        </div>

        <div class="form-buttons">
          <button type="submit" class="btn-primary">
            {{ editMode ? 'Actualizar' : 'Guardar' }}
          </button>
          <button type="button" class="btn-secondary" (click)="onCancel()">Cancelar</button>
        </div>
      </form>
</div>
         <!-- Botones de navegación -->
<div class="navigation-buttons">
  <button class="btn-primary" (click)="navigateNext()">Siguiente</button>
</div>
